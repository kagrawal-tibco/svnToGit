<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
		<title></title>
		<link rel="stylesheet" type="text/css" href="history/history.css" />
		<script src="history/history.js" language="javascript"></script>
		<script src="scripts/AC_OETags.js" language="javascript"></script>
		<script src="scripts/FABridge.js" type="text/javascript"></script>
		<style>
			body { margin: 0px; overflow:hidden }
		</style>
		<script language="JavaScript" type="text/javascript">
			<!--
			// -----------------------------------------------------------------------------
			// Globals
			// Major version of Flash required
			var requiredMajorVersion = 9;
			// Minor version of Flash required
			var requiredMinorVersion = 0;
			// Minor version of Flash required
			var requiredRevision = 124;
			// -----------------------------------------------------------------------------
			
			var DEBUG = false;
			var previewComponentReady = false;
			var queuedCompleteXML = "";
			var queuedConfigXML = "";
			var queuedDataXML = "";
			
			var flexApp; // variable to hold our flex app reference
			var initCallback = function(){
				flexApp = FABridge.chartPreviewAJAXBridge.root();
				initComponent();
				if(DEBUG){
					setChartConfig(testChartConfig);
					updateChartData(testChartData);
				}
				return;
			}
			
			FABridge.addInitializationCallback("chartPreviewAJAXBridge", initCallback);
			
			function initComponent(){
				previewComponentReady = true;
				if(queuedCompleteXML != ""){
					flexApp.setCompleteXML(queuedCompleteXML);
				}
				else if(queuedConfigXML != ""){
					flexApp.setChartConfig(queuedConfigXML);
					queuedConfigXML = "";
					if(queuedDataXML != ""){
						flexApp.updateChartData(queuedDataXML);
					}
				}
				else if(queuedDataXML != ""){
					flexApp.updateChartData(queuedDataXML);
				}
				queuedCompleteXML = queuedConfigXML = queuedDataXML = "";
			}
			
			function setChartConfigAndData(configAndDataXML){
				if(flexApp != null && previewComponentReady){
					flexApp.setCompleteXML(configAndDataXML);
				}
				else{
					queuedCompleteXML = configAndDataXML;
				}
			}
			
			function setChartConfig(configXML){
				if(flexApp != null && previewComponentReady){
					flexApp.setChartConfig(configXML);
				}
				else{
					queuedConfigXML = configXML;
				}
			}
			
			function updateChartData(dataXML){
				if(flexApp != null && previewComponentReady){
					flexApp.updateChartData(dataXML);
				}
				else{
					queuedDataXML = dataXML;
				}
			}
			
			// Handle all the FSCommand messages in a Flash movie.
			function chartpreviewer_DoFSCommand(command, args) {
				var chartpreviewerObj = isInternetExplorer ? document.all.chartpreviewer : document.chartpreviewer;
				if(command == "status"){
					//alert(args);
				}
			}
			
			// Hook for Internet Explorer.
			if (navigator.appName && navigator.appName.indexOf("Microsoft") != -1 && navigator.userAgent.indexOf("Windows") != -1 && navigator.userAgent.indexOf("Windows 3.1") == -1) {
				document.write('<script language=\"VBScript\"\>\n');
				document.write('On Error Resume Next\n');
				document.write('Sub chartpreviewer_FSCommand(ByVal command, ByVal args)\n');
				document.write('	Call chartpreviewer_DoFSCommand(command, args)\n');
				document.write('End Sub\n');
				document.write('</script\>\n');
			}
			// -->
		</script>
	</head>

	<body scroll="no">
		<script language="JavaScript" type="text/javascript">
		<!--
		// Version check for the Flash Player that has the ability to start Player Product Install (6.0r65)
		var hasProductInstall = DetectFlashVer(6, 0, 65);
		
		// Version check based upon the values defined in globals
		var hasRequestedVersion = DetectFlashVer(requiredMajorVersion, requiredMinorVersion, requiredRevision);
		
		if ( hasProductInstall && !hasRequestedVersion ) {
			// DO NOT MODIFY THE FOLLOWING FOUR LINES
			// Location visited after installation is complete if installation is required
			var MMPlayerType = (isIE == true) ? "ActiveX" : "PlugIn";
			var MMredirectURL = window.location;
			document.title = document.title.slice(0, 47) + " - Flash Player Installation";
			var MMdoctitle = document.title;
			
			AC_FL_RunContent(
				"src", "playerProductInstall",
				"FlashVars", "MMredirectURL="+MMredirectURL+'&MMplayerType='+MMPlayerType+'&MMdoctitle='+MMdoctitle+"",
				"width", "100%",
				"height", "100%",
				"align", "middle",
				"id", "BEViewsChartPreview",
				"quality", "high",
				"bgcolor", "#869ca7",
				"name", "BEViewsChartPreview",
				"allowScriptAccess","sameDomain",
				"type", "application/x-shockwave-flash",
				"pluginspage", "http://www.adobe.com/go/getflashplayer"
			);
		}
		else if (hasRequestedVersion) {
			// if we've detected an acceptable version
			// embed the Flash Content SWF when all tests are passed
			AC_FL_RunContent(
					"src", "BEViewsChartPreview",
					"flashvars","bridgeName=chartPreviewAJAXBridge",
					"width", "100%",
					"height", "100%",
					"align", "middle",
					"id", "BEViewsChartPreview",
					"quality", "high",
					"bgcolor", "#869ca7",
					"name", "BEViewsChartPreview",
					"allowScriptAccess","sameDomain",
					"type", "application/x-shockwave-flash",
					"pluginspage", "http://www.adobe.com/go/getflashplayer"
			);
		  }
		  else {  // flash is too old or we can't detect the plugin
			var alternateContent = 'Alternate HTML content should be placed here. '
			+ 'This content requires the Adobe Flash Player. '
			+ '<a href=http://www.adobe.com/go/getflash/>Get Flash</a>';
			document.write(alternateContent);  // insert non-flash content
		  }
		// -->
		</script>
		<noscript>
			<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
					id="BEViewsChartPreview" width="100%" height="100%"
					codebase="http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab">
					<param name="flashvars" value="bridgeName=chartPreviewAJAXBridge"/>
					<param name="movie" value="BEViewsChartPreview.swf" />
					<param name="quality" value="high" />
					<param name="bgcolor" value="#869ca7" />
					<param name="allowScriptAccess" value="sameDomain" />
					<embed src="BEViewsChartPreview.swf" 
						name="BEViewsChartPreview"
						width="100%" height="100%"
						align="middle"
						bgcolor="#869ca7"
						play="true"
						loop="false"
						quality="high"
						allowScriptAccess="sameDomain"
						type="application/x-shockwave-flash"
						pluginspage="http://www.adobe.com/go/getflashplayer"
						flashvars="bridgeName=chartPreviewAJAXBridge">
					</embed>
			</object>
		</noscript>
	</body>
</html>
