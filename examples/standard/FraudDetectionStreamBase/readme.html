<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>     StreamBaseChannel

- TIBCO BusinessEvents&reg; Examples
</title>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="Content-Language" content="en-us" />
<link rel="Shortcut Icon" href="../../_resources/icon.gif" type="image/gif" />
<style type="text/css" media="all">@import "../../_resources/examples.css";</style>
<script type="text/javascript" src="../../_resources/examples.js" /></script>
<script type="text/javascript">
function buildForms() {
 var form;


 SendEventForm.setServer("http://localhost:8108");


 form = SendEventForm.get("createAccountForm");
 form.setDestinationPath("/Channels/HTTP/AllOps");
 form.setEventPath("/Events/CreateAccount");
 form.addProperty("AccountId", "Bob");
 form.addProperty("Balance", "20000");
 form.addProperty("AvgMonthlyBalance", "11000");
 form.build();


 form = SendEventForm.get("debitAccountForm");
 form.setDestinationPath("/Channels/HTTP/AllOps");
 form.setEventPath("/Events/Debit");
 form.addProperty("AccountId", "Bob");
 form.addProperty("Amount", "2000");
 form.build();


}
</script>
</head>
<body onLoad="buildForms()">


<h1>StreamBaseChannel</h1>


<h2>Purpose of This Example</h2>

<p>This example shows how the StreamBase channel can be used to integrate TIBCO BusinessEvents&reg; applications with TIBCO StreamBase&reg; CEP applications. Here, the Fraud Detection scenario is used to demonstrate. A StreamBase application is used to flag potentially fraudulent transactions using its aggregation operator, while the BusinessEvents application is used as Enqueuer and Dequeuer to send/receive tuples to/from Streambase applications. In this example, fraud is suspected when both of the following conditions occur:</p>
<ul>
<li>The account incurs more than three debit transactions in a two minute period.</li>
<li>The sum of the debits that occurs in a two minute period totals more than 80% of the average monthly balance of the account. </li>
</ul>

<p>NOTE: Use Google Chrome or Mozilla Firefox browsers to view the Send Button in this file. The Send button can be used to provide test data to the example application.
</p>

<h2>How to Run the Example</h2>
<p>NOTE: This sample requires that both TIBCO StreamBase CEP as well as TIBCO BusinessEvents be installed on your machine.</p>
<ol>


<li>
<p>Start the TIBCO StreamBase application using the appropriate commands for the installed version
of StreamBase.  This can be done from a command prompt or from StreamBase Studio.  For more information on launching StreamBase applications, please refer to the corresponding 
BusinessEventsFraudDetection_README.html from the StreamBase installation or to the
 <a href="https://docs.tibco.com/pub/sb-cep/10.2.0/doc/html/testdebug/index.html">StreamBase Test/Debug Guide</a>.</p>

<p>Open a command window and at the command prompt, start the TIBCO BusinessEvents engine using the following command. </p>

<pre class="commands">
cd <i>BE_HOME</i>/examples/standard/FraudDetectionStreamBase
<i>BE_HOME</i>/bin/be-engine --propFile <i>BE_HOME</i>/bin/be-engine.tra -u default -c FraudDetectionStreamBase/fdsb.cdd fdsb.ear
</pre>

<p>Adapt the command as needed, for example, if you have customized the example project, or are running it from a different directory.</p>
</li>


<li>
<p>Create an account and give it a balance and an average monthly balance. Enter a name in the Account ID field. Enter, for example, 10000 in the Balance, and 20000 in the AvgMonthlyBalance fields. Repeat this step to create multiple accounts, as desired.</p>

<form id="createAccountForm"></form>

<p>In the command window you see a message like this:
<span class="logs">#### Created account Bob.</span></p>
</li>


<li>
<p>Now debit the account. In the AccountId field, enter one of the account names you specified above. Enter the amount of the debit in the Amount field. Then click Send.</p>

<form id="debitAccountForm"></form>

<p>In the command window you see messages like this
(the actual message depends on the account balance, the average monthly balance, and other events that happened in the two minute window):
<span class="logs">#### Debiting account Bob by $1000.0</span></p>
</li>


<li>
<p>Rules in the project react to various inputs depending on current facts in the Rete network. You can try the following.</p>

<table>
<tr>
<th>Action</th>
<th>Message</th>
</tr>
<tr>
<td>In the /Events/CreateAccount form, enter the same account name two times.</td>
<td><pre class="logs">#### Account already exists: Bob</pre></td>
</tr>
<tr>
<td>In the /Events/Debit form, enter a debit amount greater than the account balance.</td>
<td><pre class="logs">#### Account ID Bob STATUS set to Suspended. <br>Balance -1000.0 is less than zero</pre></td>
</tr>
<tr>
<td>In the Events/Debit form, debit an account that was set to Suspended.</td>
<td><pre class="logs">#### Cannot debit the suspended account Bob</pre></td>
</tr>
<tr>
<td>In the Events/Debit form, match the fraud detection criteria to meet both of the following conditions:
<ul>
<li>Make 3 debits within 2 minutes</li>
<li>Make debits such that the sum of the debits occurring in a two minute period totals more than 80% of the average monthly balance of the account.</li>
</ul></td>
<td><pre class="logs">#### Account ID Bob STATUS set to Suspended. <br>Reason: 80.0% of monthly average exceeded in 120 seconds</pre></td>
</tr>
</table>
</li>

<li>
<p> To reset the data, restart the engine at the command line.</p
</li>

</ol>



<div class="footer">
<p>TIBCO BusinessEvents&reg; 5.6<br />
Copyright&copy; 2004-2019 TIBCO Software Inc. All rights reserved.</p>
</div>
</body>
</html>
