<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>     Order Management

- TIBCO BusinessEvents&reg; Examples
</title>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="Content-Language" content="en-us" />
<link rel="Shortcut Icon" href="../../_resources/icon.gif" type="image/gif" />
<style type="text/css" media="all">@import "../../_resources/examples.css";</style>
<script type="text/javascript" src="../../_resources/examples.js" /></script>
<script type="text/javascript">
function buildForms() {
 var form;


 SendEventForm.setServer("http://localhost:8011");
 
 form = SendEventForm.get("addInventoryForm");
 form.setDestinationPath("/Channels/oms/addInventoryItem");
 form.setEventPath("/Events/AddInvetoryItemEvent");
 form.addProperty("itemName", "Pencil");
 form.addProperty("itemPrice", "10");
 form.addProperty("itemQuantity", "100000");
 form.build();

 form = SendEventForm.get("createCustomerForm");
 form.setDestinationPath("/Channels/oms/createCustomer");
 form.setEventPath("/Events/CreateCustomer");
 form.addProperty("name", "Bob");
 form.addProperty("balance", "20000");
 form.addProperty("type", "Basic");
 form.build();

 

 form = SendEventForm.get("createOrderForm");
 form.setDestinationPath("/Channels/oms/createOrder");
 form.setEventPath("/Events/CreateOrderEvent");
 form.addProperty("custName", "Bob");
 form.addProperty("itemName", "Pencil");
 form.addProperty("quantity", "300");
 form.build();
 }
</script>
</head>
<body onLoad="buildForms()">


<h1>Order Management Process</h1>
<img src="../../_resources/OrderManagement.png" alt="" />

<h2>Purpose of This Example</h2>

<p>This example shows how process orchestration is used to do simple credit/debit order operations on a customer account.
<ul><li>The first message is sent via the HTTP channel using the browser from this example page to create a customer account using the create customer process.</li>
<li>The second message starts a order process in which the order and account is verified and waits for the third message to proceed </li>
<li>The third message wakes the process from wait state and closes the operations </li>
</ul>



<h2>How to Run the Example</h2>
<ol>

<li><p>For Hot deployment settings - Update <i>BE_HOME</i>/rms/bin/RMS.cdd to set appropriate hot deployment parameters. Refer to property group namely - HotDeploy (go through the documentation for more details).</p>
    </li>
	
	<li>Additionally, update the cdd for OrderManagement, located at <i>BE_HOME</i>/examples/standard/WebStudio/OrderManagement/Deployments to add properties indicating where to look for classes/artifacts to hot deploy. Typically this points to the shared location in RMS, i.e. "be.engine.cluster.externalClasses.path" (for DT) points to <i>BE_HOME</i>/rms/shared/OrderManagement/Decision_Tables and "be.cluster.ruletemplateinstances.deploy.dir" (for RTI) point to <i>BE_HOME</i>/rms/shared/OrderManagement". 
	</li>
	
	<li><p>Open a command window and at the command prompt,
        start the TIBCO BusinessEvents engine to run the cache agent. Use the following command:
        Substitute your actual value for <i>BE_HOME</i>.</p>
<pre class="commands">
cd <i>BE_HOME</i>/examples/standard/WebStudio
<i>BE_HOME</i>/bin/be-engine --propFile <i>BE_HOME</i>\bin\be-engine.tra -u cache -c OrderManagement/Deployments/oms.cdd OrderManagement.ear
</pre>

        <p>Adapt these commands as needed.
            For example, if you have customized the example project,
            or are running it from a different directory.</p>
    </li>

    <li><p>Open a second command window and at the command prompt,
        start the TIBCO BusinessEvents engine to run the inference agent. Use the following command:
        Substitute your actual value for <i>BE_HOME</i>.</p>

<pre class="commands">
cd <i>BE_HOME</i>/examples/standard/WebStudio
<i>BE_HOME</i>/bin/be-engine --propFile <i>BE_HOME</i>\bin\be-engine.tra -u default -c OrderManagement/Deployments/oms.cdd OrderManagement.ear
</pre>
        </li>

<li>
<p>Open a command window and at the command prompt, start the TIBCO BusinessEvents engine using the following command, to run the cache agent. Substitute your actual value for <i>BE_HOME</i>.</p>

<pre class="commands">
cd <i>BE_HOME</i>/rms/bin
be-rms
</pre>
<li><p>Launch the URL <code>http://localhost:8090/WebStudio/</code>
        using your web browser.</p>
    </li>

    <li><p>Login to the dashboard using <code>admin</code> as Username
        and <code>admin</code> as Password.</p>
    </li>

    <li><p>Checkout the <code>OrderManagement</code> project.</p>
        <p align="center"><image src="images/newUI/OMS_Checkout.png"/></p>
    </li>

    <li><p>Create a business rule named <code>SpecialOfferBR</code>
        based on the rule template named <code>SpecialOffers</code>.
        Set the values in the business rule as shown and save it.</p>
        <p align="center"><image src="images/newUI/OMS_SpecialOfferBR.png"/></p>
    </li>

    <li><p>Commit the changes.</p>
        <p align="center"><image src="images/newUI/OMS_Commit.png"/></p>
    </li>

    <li><p>Approve the changes.</p>
        <p align="center"><image src="images/newUI/OMS_Approve.png"/></p>
    </li>

    <li><p>Build and deploy the changes.</p>		
        <p align="center"><image src="images/newUI/OMS_BuildAndDeploy.png"/></p>
    </li>

    <li><p>You will now find <code>SpecialOfferBR.ruletemplateinstance</code>
        in <code><i>BE_HOME</i>/rms/shared/OrderManagement/BusinessRules</code>.</p>
    </li>
<li>
<p>Add the item in the inventory.If item already exists in the inventory it updates the item price and quantity.</p>
</li>
<form id="addInventoryForm"></form>
<span class="logs">
### In inventory is not exist then Inventory is created.
### Adding the item in inventory ###
### Pencil is added successfully in the inventory.
### If item is exist then Pencil is exist in the inventory.</span></p>
</li>

<p>Create an account and give it a balance and an average monthly balance. Enter a name in the name field. Enter, for example, 1000 in the Balance, and 20000 in the AvgMonthlyBalance fields. Repeat this step to create multiple accounts, as desired.</p>
<span> Valid Types are : Basic,Standard,Premium and Super.These values are case-sensitive and for any other value default value will be set as Basic'.</span>
<form id="createCustomerForm"></form>

<p>In the command window you see a message like this:
<span class="logs">
#### Creating customer:Bob with balance:20000.0
#### Adding deposit to account:Bob for $1000
#### Deposit added to account:Bob Balance:21000.0</span></p>
</li>


<li>
<p>Now debit the account. In the AccountId field, enter one of the account names you specified above. Enter the amount of the debit in the Amount field. Then click Send.</p>

<form id="createOrderForm"></form>

<p>In the command window you see messages like this:
<span class="logs">
#### Checking customer...
#### Checking balance...
#### Executing Order...
#### Bob received 10.0 % discount
#### Bob received $300.0 discount on $3000.0

### Status of Inventory:
-------------------------------------------------
Name		Price		Quantity
-------------------------------------------------
Pencil		10.0		99700
-------------------------------------------------

### Status of Order Factory:
---------------------------------------------------------------------
OrderId		Customer Name		Order CreationTime
---------------------------------------------------------------------
OR#Bob		Bob			08/09/2014 09:52:50
---------------------------------------------------------------------
#### Executed order for customer:Bob Remaining balance:18300
</span></p>
</li>

<li>
<p> To reset the data, restart the engine running the process agent at the command line.</p>
</li>

</ol>



<div class="footer">
<p>TIBCO BusinessEvents&reg; 5.6<br />
Copyright&copy; 2004-2019 TIBCO Software Inc. All rights reserved.</p>
</div>
</body>
</html>
