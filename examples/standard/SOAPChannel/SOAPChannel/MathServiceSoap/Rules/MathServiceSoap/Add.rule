/**
 * @description 
 * @author null
 */
rule MathServiceSoap.Rules.MathServiceSoap.Add {
	attribute {
		priority = 5;
		forwardChain = true;
	}
	declare {
		MathServiceSoap.Events.AddSoapIn	soapeventin;
		
	}
	when {
		
	}
	then {
		System.debugOut("###ADDITION###");
		
		System.debugOut("###Printing SOAPEventIn Payload###");
		System.debugOut(soapeventin@payload);
		
		System.debugOut("###Getting the first and second value and adding###");
		System.debugOut("The first number for addition is ="+XPath.evalAsDouble("xpath://<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xpath>\n    <expr>$soapeventin/payload/xsd5:message/xsd3:Envelope/xsd3:Body/xsd2:Add/a</expr>\n    <namespaces>\n        <namespace URI=\"http://www.tibco.com/TNT/webservices/\" pfx=\"xsd2\"/>\n        <namespace URI=\"http://www.w3.org/2001/XMLSchema\" pfx=\"xsd\"/>\n        <namespace URI=\"www.tibco.com/be/ontology/MathService/MathServiceSoap/Events/AddSoapIn\" pfx=\"xsd4\"/>\n        <namespace URI=\"http://schemas.xmlsoap.org/soap/envelope/\" pfx=\"xsd3\"/>\n        <namespace URI=\"www.tibco.com/be/ontology/MathServiceSoap/Events/AddSoapIn\" pfx=\"xsd5\"/>\n    </namespaces>\n    <variables>\n        <variable>soapeventin</variable>\n    </variables>\n</xpath>"));
		System.debugOut("The second number for addition is ="+XPath.evalAsDouble("xpath://<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xpath>\n    <expr>$soapeventin/payload/xsd5:message/xsd3:Envelope/xsd3:Body/xsd2:Add/b</expr>\n    <namespaces>\n        <namespace URI=\"http://www.tibco.com/TNT/webservices/\" pfx=\"xsd2\"/>\n        <namespace URI=\"http://www.w3.org/2001/XMLSchema\" pfx=\"xsd\"/>\n        <namespace URI=\"www.tibco.com/be/ontology/MathService/MathServiceSoap/Events/AddSoapIn\" pfx=\"xsd4\"/>\n        <namespace URI=\"http://schemas.xmlsoap.org/soap/envelope/\" pfx=\"xsd3\"/>\n        <namespace URI=\"www.tibco.com/be/ontology/MathServiceSoap/Events/AddSoapIn\" pfx=\"xsd5\"/>\n    </namespaces>\n    <variables>\n        <variable>soapeventin</variable>\n    </variables>\n</xpath>"));
		
		System.debugOut("###Creating the SoapEventOut###");
		MathServiceSoap.Events.AddSoapOut soapeventout=Event.createEvent("xslt://{{/MathServiceSoap/Events/AddSoapOut}}<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xsl:stylesheet xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:ns=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns1=\"www.tibco.com/be/ontology/MathServiceSoap/Events/AddSoapIn\" xmlns:ns2=\"http://www.tibco.com/TNT/webservices/\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:ns3=\"www.tibco.com/be/ontology/MathServiceSoap/Events/AddSoapOut\" version=\"1.0\" exclude-result-prefixes=\"ns2 ns1 ns xsd\">\n    <xsl:output method=\"xml\"/>\n    <xsl:param name=\"soapeventin\"/>\n    <xsl:template match=\"/\">\n        <createEvent>\n            <event>\n                <payload>\n                    <ns3:message>\n                        <ns:Envelope>\n                            <ns:Body>\n                                <ns2:AddResponse>\n                                    <AddResult>\n                                        <xsl:value-of select=\"$soapeventin/payload/ns1:message/ns:Envelope/ns:Body/ns2:Add/a + $soapeventin/payload/ns1:message/ns:Envelope/ns:Body/ns2:Add/b\"/>\n                                    </AddResult>\n                                </ns2:AddResponse>\n                            </ns:Body>\n                        </ns:Envelope>\n                    </ns3:message>\n                </payload>\n            </event>\n        </createEvent>\n    </xsl:template>\n</xsl:stylesheet>");
		System.debugOut("###The addition of the 2 numbers are=###"+XPath.evalAsDouble("xpath://<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xpath>\n    <expr>$soapeventout/payload/xsd6:message/xsd3:Envelope/xsd3:Body/xsd2:AddResponse/AddResult</expr>\n    <namespaces>\n        <namespace URI=\"http://www.tibco.com/TNT/webservices/\" pfx=\"xsd2\"/>\n        <namespace URI=\"http://www.w3.org/2001/XMLSchema\" pfx=\"xsd\"/>\n        <namespace URI=\"www.tibco.com/be/ontology/MathService/MathServiceSoap/Events/AddSoapIn\" pfx=\"xsd4\"/>\n        <namespace URI=\"http://schemas.xmlsoap.org/soap/envelope/\" pfx=\"xsd3\"/>\n        <namespace URI=\"www.tibco.com/be/ontology/MathServiceSoap/Events/AddSoapOut\" pfx=\"xsd6\"/>\n        <namespace URI=\"www.tibco.com/be/ontology/MathService/MathServiceSoap/Events/AddSoapOut\" pfx=\"xsd5\"/>\n    </namespaces>\n    <variables>\n        <variable>soapeventout</variable>\n    </variables>\n</xpath>"));
		System.debugOut("###Printing SOAPEventOut Payload###");
		System.debugOut(soapeventout@payload);
		Event.replyEvent(soapeventin,soapeventout);
		}
}